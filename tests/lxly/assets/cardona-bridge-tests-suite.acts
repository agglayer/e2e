-- java -Doutput=nist -Ddoi=2 -Dchandler=solver -jar ./acts_3.3.jar cardona-bridge-tests-suite.acts
-- java -Doutput=nist -Ddoi=5 -jar ./acts_3.3.jar cardona-bridge-tests-suite.acts

[System]
Name: Bridge Tests Suite

[Parameter]
DestinationAddress (enum): EOA, Precompile, BridgeContract
BridgeType (enum): Asset, Message, Weth
Token (enum): Buggy, WETH, LocalERC20, GasToken, NativeEther
MetaData (enum): 0x, Random, Huge, Max
ForceUpdate (boolean): True, False
Amount (enum): 0, 1, Max, Random
ExpectedResultProcess (enum): Success, 0x4e487b71, 0x6f625c40, 0x37e391c3, 0x14603c01, 0xe282c0ba, 0x23d72133, 0x6747a288, 0xe0417cec, TransferAmountExceedsBalance, BridgeWETHNotAllowed, BridgeTransactionFailed, InvalidRLPTooLong, OversizedData, NotFound
ExpectedResultClaim (enum): Success, N/A, 0x4e487b71, 0x37e391c3, 0x23d72133, 0x14603c01, 0x6747a288, 0xe0417cec, InvalidRLPTooLong, OversizedData
FromNetwork (int): 0, 51, 52
ToNetwork (int):   0, 51, 52
-- FromNetwork (int): 0, 1, 48, 50, 51, 52
-- ToNetwork (int):   0, 1, 48, 50, 51, 52

[Constraint]
-- Basic logical constraints
ExpectedResultProcess != "Success" => ExpectedResultClaim == "N/A"
ExpectedResultProcess == "Success" => ExpectedResultClaim != "N/A"
FromNetwork != ToNetwork

-- WETH bridge type is absolutely not allowed
BridgeType == "Weth" => ExpectedResultProcess == "BridgeWETHNotAllowed" && ExpectedResultClaim == "N/A"
BridgeType == "Weth" => Token == "WETH" || Token == "NativeEther" || Token == "GasToken" || Token == "Buggy" || Token == "LocalERC20"

-- Max amount insufficient funds failures
Token == "GasToken" && Amount == "Max" && BridgeType == "Message" => ExpectedResultProcess == "TransferAmountExceedsBalance"
Token == "GasToken" && Amount == "Max" && BridgeType == "Asset" => ExpectedResultProcess == "TransferAmountExceedsBalance"
Token == "NativeEther" && Amount == "Max" && BridgeType == "Message" => ExpectedResultProcess == "TransferAmountExceedsBalance"
Token == "NativeEther" && Amount == "Max" && BridgeType == "Asset" => ExpectedResultProcess == "TransferAmountExceedsBalance"
Token == "WETH" && Amount == "Max" && BridgeType == "Asset" => ExpectedResultProcess == "TransferAmountExceedsBalance"
Token == "WETH" && Amount == "Max" && BridgeType == "Message" => ExpectedResultProcess == "TransferAmountExceedsBalance"

-- Oversized data failures - Based on test results, these patterns fail with OversizedData
Token == "WETH" && MetaData == "Max" && Amount == "Random" => ExpectedResultProcess == "OversizedData"
Token == "LocalERC20" && MetaData == "Max" && Amount == "Max" => ExpectedResultProcess == "OversizedData" 
Token == "NativeEther" && MetaData == "Max" && Amount == "0" => ExpectedResultProcess == "OversizedData"
Token == "GasToken" && MetaData == "Max" && Amount == "1" => ExpectedResultProcess == "OversizedData"
BridgeType != "Weth" && !(Token == "GasToken" && Amount == "Max") && !(Token == "NativeEther" && Amount == "Max") && !(Token == "WETH" && Amount == "Max" && BridgeType == "Asset") && !(Token == "LocalERC20" && MetaData == "Random" && BridgeType == "Asset") && !(Token == "Buggy" && MetaData == "Random" && BridgeType == "Asset") => ExpectedResultProcess == "Success"

-- Asset bridge with 0x metadata
ExpectedResultProcess == "Success" && BridgeType == "Asset" && MetaData == "0x" && Token == "Buggy" => ExpectedResultClaim == "Success"
ExpectedResultProcess == "Success" && BridgeType == "Asset" && MetaData == "0x" && Token == "LocalERC20" => ExpectedResultClaim == "Success"
ExpectedResultProcess == "Success" && BridgeType == "Asset" && MetaData == "0x" && Token == "WETH" => ExpectedResultClaim == "0x6747a288"
ExpectedResultProcess == "Success" && BridgeType == "Asset" && MetaData == "0x" && Token == "NativeEther" => ExpectedResultClaim == "Success"
ExpectedResultProcess == "Success" && BridgeType == "Asset" && MetaData == "0x" && Token == "GasToken" => ExpectedResultClaim == "Success"

-- Override Max and Huge metadata patterns
ExpectedResultProcess == "Success" && MetaData == "Max" => ExpectedResultClaim == "0x6747a288"
ExpectedResultProcess == "Success" && Amount == "Max" && MetaData == "0x" && Token == "LocalERC20" => ExpectedResultClaim == "0xe0417cec"
Token == "GasToken" && Amount == "1" && MetaData == "Max" && BridgeType == "Message" => ExpectedResultProcess == "Success"
Token == "WETH" && Amount == "0" && MetaData == "Huge" && BridgeType == "Message" => ExpectedResultProcess == "Success"
Token == "LocalERC20" && Amount == "Max" && MetaData == "Max" && BridgeType == "Message" => ExpectedResultProcess == "Success"
Token == "NativeEther" && Amount == "0" && MetaData == "Max" && BridgeType == "Message" => ExpectedResultProcess == "Success"
Token == "WETH" && Amount == "Random" && MetaData == "Max" && BridgeType == "Message" => ExpectedResultProcess == "Success"
Token == "WETH" && Amount == "0" && MetaData == "Huge" && BridgeType == "Asset" => ExpectedResultProcess == "Success"

-- Multinetwork localbalancetree underflow handling
Token == "WETH" && FromNetwork != 0 && ToNetwork != 0 => ExpectedResultProcess == "0x14603c01"
Token == "GasToken" && MetaData == "Huge" && BridgeType == "Asset" && FromNetwork != 0 && ToNetwork == 0 => ExpectedResultProcess == "0x14603c01"
Token == "NativeEther" && FromNetwork != 0 && ToNetwork == 0 => ExpectedResultProcess == "0x14603c01"
Token == "NativeEther" && FromNetwork != 0 && ToNetwork != 0 => ExpectedResultProcess == "0x14603c01"
Token == "GasToken" && FromNetwork != 0 && ToNetwork == 0 => ExpectedResultProcess == "0x14603c01"
Token == "GasToken" && FromNetwork != 0 && ToNetwork != 0 => ExpectedResultProcess == "0x14603c01"

-- NotValidSignature patterns
ExpectedResultProcess == "Success" && Amount == "Max" && MetaData == "Huge" && Token == "LocalERC20" => ExpectedResultProcess == "0xe282c0ba"
Token == "Buggy" && Amount == "0" && MetaData == "Random"  => ExpectedResultProcess == "0xe282c0ba"
Token == "Buggy" && Amount == "0" && MetaData == "Huge"  => ExpectedResultProcess == "0xe282c0ba"
Token == "LocalERC20" && MetaData == "Random"  => ExpectedResultProcess == "0xe282c0ba"
Token == "LocalERC20" && MetaData == "Huge"  => ExpectedResultProcess == "0xe282c0ba"

-- Buggy contract handling
Token == "Buggy" && Amount == "Max" && MetaData == "0x" && BridgeType == "Message" => ExpectedResultClaim == "0x6747a288"
Token == "Buggy" && Amount == "Max" && MetaData == "0x" && BridgeType == "Asset" => ExpectedResultClaim == "0x4e487b71"
Token == "Buggy" && BridgeType == "Asset" && Amount != "0" => ExpectedResultClaim == "0x4e487b71"

-- Message bridge handling
Token == "LocalERC20" && BridgeType == "Message" => ExpectedResultClaim == "0x37e391c3"
Token == "Buggy" && BridgeType == "Message" => ExpectedResultClaim == "0x37e391c3"
Token == "WETH" && BridgeType == "Message" => ExpectedResultClaim == "0x37e391c3"
Token == "GasToken" && BridgeType == "Message" => ExpectedResultClaim == "0x37e391c3"
ExpectedResultProcess == "Success" && BridgeType == "Message" && MetaData == "Random" => ExpectedResultClaim == "0x37e391c3"

-- Asset bridge to bridge contract address handling
Token == "NativeEther" && DestinationAddress == "BridgeContract" && BridgeType == "Asset" => ExpectedResultClaim == "0x6747a288"
DestinationAddress == "BridgeContract" && BridgeType == "Asset" => ExpectedResultClaim == "0x6747a288"

-- Message bridge to bridge contract address handling
DestinationAddress == "BridgeContract" && BridgeType == "Message" => ExpectedResultClaim == "0x37e391c3"

-- Default fallback for any remaining successful cases
ExpectedResultProcess == "Success" => ExpectedResultClaim == "Success"